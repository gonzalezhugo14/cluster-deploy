{% raw %}
    #
    # Pod alerts (from cAdvisor / kube-state-metrics)
    #
    - name: pod-alerts
      rules:

      #
      # Pod restarting count > 5 times per minute
      #
      - alert: PodRestartingTooMuch
        expr: rate(kube_pod_container_status_restarts[1m]) > 1 / (5 * 60)
        for: 1h
        labels:
          notify: tech
          severity: warning
        annotations:
          summary: "{{ $labels.kubernetes_namespace }}/{{ $labels.pod }}: Pod restarts too much"
          description: "{{ $labels.kubernetes_namespace }}/{{ $labels.pod }}: Pod restarts more than 5 times per minute"

      #
      # Alert for pod that is unreachable for > 5 minutes
      #
      - alert: PodIsDown
        expr: up{job="kubernetes-service-endpoints"} == 0
        for: 5m
        labels:
          notify: sre
          severity: warning
        annotations:
          summary: "{{ $labels.kubernetes_namespace }}/{{ $labels.kubernetes_pod_name }}: Pod is down"
          description: "{{ $labels.kubernetes_namespace }}/{{ $labels.kubernetes_pod_name }}: Pod is down for more than 5 minutes"

{% endraw %}