{% raw %}
    #
    # Pod alerts (from cAdvisor / kube-state-metrics)
    #
    - name: pod-alerts
      rules:

      #
      # Pod restarting count > 5 times per minute
      #
      - alert: PodRestartingTooMuch
        expr: rate(kube_pod_container_status_restarts{job="kubernetes-service-endpoints"}[1m])
          > 1 / (5 * 60)
        for: 1h
        labels:
          notify: tech
          severity: warning
        annotations:
          summary: "{{ $labels.instance }}: Pod restarts too much"
          description: "{{ $labels.instance }}: Pod restarts more than 5 times per minute"

      #
      # Alert for any instance that is unreachable for > 5 minutes
      #
      - alert: InstanceDown
        expr: up == 0
        for: 5m
        labels:
          notify: sre
          severity: warning
        annotations:
          summary: "{{ $labels.instance }}: Pod is down"
          description: "{{ $labels.instance }}: Pod is down for more than 5 minutes"

{% endraw %}